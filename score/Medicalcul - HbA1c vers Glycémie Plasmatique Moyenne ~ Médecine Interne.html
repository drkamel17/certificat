<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medicalcul - HbA1c vers Glycémie Plasmatique Moyenne ~ Médecine Interne</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            background-color: #f8f9fa;
        }

        .form-row {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            gap: 10px;
        }

        .form-row label {
            min-width: 150px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-row input[type="number"], 
        .form-row select {
            padding: 10px;
            border: 2px solid #3498db;
            border-radius: 6px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s;
        }

        .form-row input[type="number"]:focus, 
        .form-row select:focus {
            border-color: #e74c3c;
            box-shadow: 0 0 0 2px rgba(231,76,60,0.2);
        }

        .submit-section {
            text-align: center;
            margin: 25px 0;
            padding: 20px;
        }

        .calculate-btn {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .calculate-btn:active {
            transform: translateY(0);
        }

        .result-section {
            background-color: #e8f4fc;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            margin: 20px 0;
            border: 2px dashed #3498db;
        }

        .result-label {
            font-size: 1.2em;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .result-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #e74c3c;
            background: white;
            padding: 10px;
            border-radius: 6px;
            display: inline-block;
            min-width: 120px;
            margin: 0 5px;
        }

        .interpretation {
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            color: #2c3e50;
        }

        .references {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .references a {
            color: #2980b9;
            text-decoration: none;
        }

        .references a:hover {
            text-decoration: underline;
        }

        .footer {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            border-radius: 15px;
            margin-top: 20px;
        }

        .footer-links {
            margin: 10px 0;
        }

        .footer-links a {
            color: #3498db;
            text-decoration: none;
            margin: 0 10px;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: #f39c12;
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                align-items: stretch;
            }
            
            .form-row label {
                min-width: auto;
                margin-bottom: 5px;
            }
            
            body {
                padding: 10px;
            }
            
            .content-card {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>HbA1c vers<br>Glycémie Plasmatique Moyenne</h1>
            <p>Médecine Interne</p>
        </div>

        <div class="content-card">
            <form name="Form" id="Form">
                <div class="form-group">
                    <div class="form-row">
                        <label for="vSrc">HbA1c :</label>
                        <input name="vSrc" type="number" lang="en" id="vSrc" style="width:100px" onchange="f_Calculer()">
                        <select name="vUnit" id="vUnit" onchange="f_Calculer()">
                            <option value="1">%</option>
                            <option value="0">mmol/mol</option>
                        </select>
                    </div>
                </div>

                <div class="submit-section">
                    <button type="button" class="calculate-btn" onclick="f_Calculer()">Calculer</button>
                </div>

                <div class="result-section">
                    <div class="result-label">Glycémie plasmatique moyenne :</div>
                    <div>
                        <input name="Resultatg" type="text" id="Resultatg" style="width:80px; text-align:center; font-weight:bold; font-size:1.2em;" readonly="readonly"> g/l
                        <input name="Resultatmol" type="text" id="Resultatmol" style="width:80px; text-align:center; font-weight:bold; font-size:1.2em;" readonly="readonly"> mmol/l
                    </div>
                </div>
            </form>
        </div>

        <div class="interpretation">
            <strong>Interprétation :</strong><br>
            L'hémoglobine glyquée (HbA1C) est le reflet de l'équilibre glycémique des trois derniers mois. Cette formule permet de faire le lien entre HbA1c et la glycémie plasmatique moyenne présente chez un patient.
        </div>

        <div class="references">
            <strong>Références :</strong><br>
            Formule: Glycémie Moyenne = HbA1c (en %) x 1,59 - 2,59.<br>
            David M. Nathan, Judith Kuenen, Rikke Borg et al. Translating the A1C Assay Into Estimated Average Glucose Values. Diabetes Care. 2008 Aug; 31(8): 1473–1478.
        </div>

        <div class="footer">
            <div class="footer-links">
                <a href="index.html">[Racine]</a>
            </div>
        </div>
    </div>

    <script>
        // Fonction de calcul de la page
        function f_Calculer() {
            // Vérifier si le champ d'entrée est vide
            var Src = document.Form.vSrc.value * 1;
            
            if (document.Form.vSrc.value === "" || isNaN(Src)) {
                // Si le champ est vide, vider les résultats
                document.Form.Resultatg.value = "";
                document.Form.Resultatmol.value = "";
                return;
            }
            
            // calcul du résultat
            if(document.Form.vUnit.value == 0) {
                var HbA1c = Math.round(((Src - 2.152) / 0.09148)*10) / 10;
            } else {
                var HbA1c = Src;
            }
            
            var Res1 = (1.59 * HbA1c) - 2.59;
            var Res2 = Res1 / 5.5;

            // Affichage du résultat
            document.Form.Resultatg.value = Res2;
            document.Form.Resultatmol.value = Res1;

            try {
                if (typeof MSSAndroidFunction !== 'undefined') {
                    MSSAndroidFunction.storeHistory("hba1c2gpm.html", "HbA1c vers Glycémie Moyenne", "medecine_interne", "Glycémie (g/l):~Glycémie (mmol/l):", Res2 + "~" + Res1);
                }
            } catch (e) {
                console.log("Fonction Android non disponible");
            }
        }

        // Initialiser au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            f_Calculer();
        });
    </script>
</body>
</html>